# OTC在庫管理システム - 'otcMgmt'

## 概要
このシステムは、OTC(一般医薬品)に関する商品の仕入れや売り上げを集計し、月次の在庫状況を管理するためのものです。
POSレジ導入までの一時的なシステムとしてGoogleスプレッドシートとGoogleフォームを使用しています。
毎月の仕入数・売上数を自動で集計し、理論在庫や棚卸差異を簡単に把握できるように設計されています。

## 構成
プロジェクトには以下の主要なシートがあります:

1. **商品一覧**
    - 商品情報（商品名、原価、税率）を登録。
    - これらのデータは、月次の集計シートに転記されます。

2. **売上数**
    - 売上日、商品名、販売個数を入力するシートです。
    - Googleフォームに紐づけており、入力データは自動で反映されます。

3. **仕入数**
    - 仕入日、商品名、入庫数を入力するシートです。
    - こちらもGoogleフォームに紐づけられており、入力データは自動で反映されます。

4. **月次集計シート**
    - '2024_11'のような形式で月ごとにシートが作成され、集計を行います。
    - 以下の情報が含まれます。
        - 商品名、原価、税率、仕入数合計、売上合計、理論在庫、在庫個数、棚卸差異、棚卸金額（税抜・税込）。

## 使用方法

1. 各月の集計シート（例： '2024_11'）を作成します。
2. 集計シートに設置された「データ取得ボタン」を押すことで、以下のデータが自動的に反映されます:
    - **商品名・原価・税率**は、　商品一覧から転記
    - **仕入数合計**は、該当月の仕入表から自動集計。
    - **売上合計**は、該当月の売上表から自動集計。

3. 集計シートのF列からJ列までは手動で入力またはシート関数を使って計算を行います。

##　スクリプト構成
このプロジェクトには３つの子スクリプトが存在し、これらが親スクリプトで一括実行されます。

### 子スクリプト
1. **商品データ転記スクリプト**
    - 商品一覧シートから商品名、原価、税率を集計シートに転記します。

2. **仕入数集計スクリプト**
    - 集計期間（例: 2024年11月）の仕入数を仕入表から集計し、集計シートに反映します。

3. **売上数集計スクリプト**
    -集計期間の売上数を売上表から集計し、集計シートに反映します。

### 親スクリプト
親スクリプトは、上記３つの子スクリプトを一括実行する役割を担っています。ボタン操作により、これらのスクリプト
がまとめて操作します。

##　注意点
- **F列からJ列のデータ**はスクリプトではなく、手動で入力やシート関数で計算を行います。
- フォームのトリガーが複雑になりがちなので、必要に応じて手動での確認と調整を行うことをお勧めします。

## ライセンス
このプロジェクトはMITライセンスのもとでライセンスされています。詳細は[LICENSE](LICENSE)ファイルを参照してください。